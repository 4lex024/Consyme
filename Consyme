-- This file was protected using Luraph Obfuscator v14.3 [https://lura.ph/]

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Rayfield Example Window",
   Icon = 0, -- Icon in Topbar. Can use Lucide Icons (string) or Roblox Image (number). 0 to use no icon (default).
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by Sirius",
   ShowText = "Rayfield", -- for mobile users to unhide rayfield, change if you'd like
   Theme = "Default", -- Check https://docs.sirius.menu/rayfield/configuration/themes

   ToggleUIKeybind = "K", -- The keybind to toggle the UI visibility (string like "K" or Enum.KeyCode)

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false, -- Prevents Rayfield from warning when the script has a version mismatch with the interface

   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil, -- Create a custom folder for your hub/game
      FileName = "Big Hub"
   },

   Discord = {
      Enabled = false, -- Prompt the user to join your Discord server if their executor supports it
      Invite = "noinvitelink", -- The Discord invite code, do not include discord.gg/. E.g. discord.gg/ ABCD would be ABCD
      RememberJoins = true -- Set this to false to make them join the discord every time they load it up
   },

   KeySystem = false, -- Set this to true to use our key system
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided", -- Use this to tell the user how to get a key
      FileName = "Key", -- It is recommended to use something unique as other scripts using Rayfield may overwrite your key file
      SaveKey = true, -- The user's key will be saved, but if you change the key, they will be unable to use your script
      GrabKeyFromSite = false, -- If this is true, set Key below to the RAW site you would like Rayfield to get the key from
      Key = {"Hello"} -- List of keys that will be accepted by the system, can be RAW file links (pastebin, github etc) or simple strings ("hello","key22")
   }
})

local MainTab = Window:CreateTab("Home", 4483362458) -- Title, Image

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local ESPEnabled = false
local ESPCache = {}

local function AddESP(player)
	if player == LocalPlayer then return end
	if ESPCache[player] then return end

	local function CreateBox(part)
		local box = Instance.new("BoxHandleAdornment")
		box.Name = "ESPBox"
		box.Adornee = part
		box.Size = part.Size + Vector3.new(0.1, 0.1, 0.1)
		box.AlwaysOnTop = true
		box.ZIndex = 5
		box.Transparency = 0.5
		box.Color3 = (player.Team == LocalPlayer.Team) and Color3.fromRGB(0, 0, 255) or Color3.fromRGB(255, 0, 0)
		box.Parent = part
	end

	local function CreateESP()
		if not player.Character then return end
		for _, part in pairs(player.Character:GetChildren()) do
			if part:IsA("BasePart") then
				if not part:FindFirstChild("ESPBox") then
					CreateBox(part)
				end
			end
		end
	end

	CreateESP()

	local CharacterAddedConn = player.CharacterAdded:Connect(function(char)
		char:WaitForChild("HumanoidRootPart")
		task.wait(0.1)
		if ESPEnabled then
			CreateESP()
		end
	end)

	ESPCache[player] = CharacterAddedConn
end

local function RemoveESP()
	for player, conn in pairs(ESPCache) do
		if conn then conn:Disconnect() end
		if player.Character then
			for _, part in pairs(player.Character:GetChildren()) do
				if part:IsA("BasePart") and part:FindFirstChild("ESPBox") then
					part.ESPBox:Destroy()
				end
			end
		end
	end
	table.clear(ESPCache)
end

local Toggle = MainTab:CreateToggle({
	Name = "ESP Super Ringan",
	CurrentValue = false,
	Flag = "ToggleESP",
	Callback = function(Value)
		ESPEnabled = Value
		if not Value then
			RemoveESP()
		else
			for _, player in pairs(Players:GetPlayers()) do
				AddESP(player)
			end
		end
	end,
})

Players.PlayerAdded:Connect(function(player)
	if ESPEnabled then
		AddESP(player)
	end
end)

Players.PlayerRemoving:Connect(function(player)
	if ESPCache[player] then
		ESPCache[player]:Disconnect()
		ESPCache[player] = nil
	end
end)

RunService.RenderStepped:Connect(function()
	if ESPEnabled then
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LocalPlayer and player.Character then
				for _, part in pairs(player.Character:GetChildren()) do
					if part:IsA("BasePart") and not part:FindFirstChild("ESPBox") then
						local box = Instance.new("BoxHandleAdornment")
						box.Name = "ESPBox"
						box.Adornee = part
						box.Size = part.Size + Vector3.new(0.1, 0.1, 0.1)
						box.AlwaysOnTop = true
						box.ZIndex = 5
						box.Transparency = 0.5
						box.Color3 = (player.Team == LocalPlayer.Team) and Color3.fromRGB(0, 0, 255) or Color3.fromRGB(255, 0, 0)
						box.Parent = part
					end
				end
			end
		end
	end
end)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local VirtualInputManager = game:GetService("VirtualInputManager")
local LocalPlayer = Players.LocalPlayer

local AutoAimEnabled = false
local HoldingShift = false
local AutoAimConnection
local PredictSpeed = 0 -- bisa diubah lewat Input GUI

local AutoClickEEnabled = false
local AutoClickEConnection

local AutoFireEnabled = false
local LastFireTime = 0
local FireRate = 0.1

local RaycastParams = RaycastParams.new()
RaycastParams.FilterDescendantsInstances = {LocalPlayer.Character}
RaycastParams.FilterType = Enum.RaycastFilterType.Blacklist

-- FOV Circle
local Drawing = Drawing or getgenv().Drawing
local FOVSize = 100
local FOVCircle = Drawing.new("Circle")
FOVCircle.Visible = false -- Default off
FOVCircle.Color = Color3.fromRGB(255, 255, 255)
FOVCircle.Thickness = 1
FOVCircle.Transparency = 1
FOVCircle.Filled = false
FOVCircle.Radius = FOVSize
FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)

RunService.RenderStepped:Connect(function()
	FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
	FOVCircle.Radius = FOVSize
end)

-- Slider FOV
local Slider = MainTab:CreateSlider({
	Name = "FOV",
	Range = {0, 300},
	Increment = 5,
	Suffix = "px",
	CurrentValue = FOVSize,
	Flag = "Slider1",
	Callback = function(Value)
		FOVSize = Value
	end,
})

-- Toggle FOV Circle
local Toggle = MainTab:CreateToggle({
	Name = "FOV Circle",
	CurrentValue = false,
	Flag = "ToggleFOV",
	Callback = function(Value)
		FOVCircle.Visible = Value
	end,
})

-- Input Prediksi Kecepatan
local Input = MainTab:CreateInput({
	Name = "Prediction Speed",
	CurrentValue = "",
	PlaceholderText = "Contoh: 0.12",
	RemoveTextAfterFocusLost = false,
	Flag = "Input1",
	Callback = function(Text)
		local num = tonumber(Text)
		if num then
			PredictSpeed = num
			print("Prediction Speed diatur ke:", PredictSpeed)
		else
			print("Input tidak valid, harus angka.")
		end
	end,
})

-- Detect Shift Key
UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if input.KeyCode == Enum.KeyCode.LeftShift then
		HoldingShift = true
	end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
	if input.KeyCode == Enum.KeyCode.LeftShift then
		HoldingShift = false
	end
end)

-- Toggle Auto Aim
local Toggle = MainTab:CreateToggle({
	Name = "Auto Aim Musuh Terdekat Crosshair (Hold Shift)",
	CurrentValue = false,
	Flag = "Toggle1",
	Callback = function(Value)
		AutoAimEnabled = Value

		if AutoAimEnabled then
			print("Auto Aim Aktif")

			AutoAimConnection = RunService.RenderStepped:Connect(function()
				if HoldingShift then
					local ClosestTarget
					local ClosestDistanceFromCrosshair = FOVSize

					for _, player in pairs(Players:GetPlayers()) do
						if player ~= LocalPlayer
						and player.Team ~= LocalPlayer.Team
						and player.Character
						and player.Character:FindFirstChild("Head") then

							local head = player.Character.Head
							local humanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")

							if humanoidRootPart then
								local RayResult = workspace:Raycast(Camera.CFrame.Position, (head.Position - Camera.CFrame.Position).Unit * (Camera.CFrame.Position - head.Position).Magnitude, RaycastParams)
								if RayResult and RayResult.Instance:IsDescendantOf(player.Character) then
									local predictedPos = head.Position
									if PredictSpeed > 0 then
										-- Auto Prediction (arah + kecepatan target)
										predictedPos = head.Position + (humanoidRootPart.Velocity * PredictSpeed)
									end

									local ScreenPos, OnScreen = Camera:WorldToViewportPoint(predictedPos)
									if OnScreen then
										local ScreenCenter = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
										local HeadVector2 = Vector2.new(ScreenPos.X, ScreenPos.Y)
										local DistanceFromCrosshair = (HeadVector2 - ScreenCenter).Magnitude

										if DistanceFromCrosshair <= FOVSize and DistanceFromCrosshair < ClosestDistanceFromCrosshair then
											ClosestDistanceFromCrosshair = DistanceFromCrosshair
											ClosestTarget = predictedPos
										end
									end
								end
							end
						end
					end

					if ClosestTarget then
						Camera.CFrame = CFrame.new(Camera.CFrame.Position, ClosestTarget)

						if AutoFireEnabled and tick() - LastFireTime >= FireRate then
							VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0)
							task.wait(0.01)
							VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0)
							LastFireTime = tick()
						end
					end
				end
			end)

		else
			print("Auto Aim Nonaktif")
			if AutoAimConnection then
				AutoAimConnection:Disconnect()
				AutoAimConnection = nil
			end
		end
	end,
})

-- Toggle Auto Click E
local Toggle = MainTab:CreateToggle({
	Name = "Auto Click E",
	CurrentValue = false,
	Flag = "ToggleAutoClickE",
	Callback = function(Value)
		AutoClickEEnabled = Value

		if AutoClickEEnabled then
			print("Auto Click E Aktif")

			AutoClickEConnection = RunService.Heartbeat:Connect(function()
				VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
				task.wait(0.05)
				VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
			end)

		else
			print("Auto Click E Nonaktif")
			if AutoClickEConnection then
				AutoClickEConnection:Disconnect()
				AutoClickEConnection = nil
			end
		end
	end,
})

-- Toggle Auto Fire
local Toggle = MainTab:CreateToggle({
	Name = "Auto Fire (Ketika Aim Lock)",
	CurrentValue = false,
	Flag = "ToggleAutoFire",
	Callback = function(Value)
		AutoFireEnabled = Value

		if AutoFireEnabled then
			print("Auto Fire Aktif")
		else
			print("Auto Fire Nonaktif")
		end
	end,
})

local Toggle = MainTab:CreateToggle({
    Name = "ESP Item (Gifts)",
    CurrentValue = false,
    Flag = "Gift_Highlight_ESP",
    Callback = function(Value)
        _G.GiftESP_Active = Value
        
        -- Fungsi untuk menghapus Highlight agar tidak menumpuk
        local function clearESP()
            for _, v in pairs(game.Workspace:GetDescendants()) do
                if v.Name == "Gift_Highlight" then
                    v:Destroy()
                end
            end
        end

        if _G.GiftESP_Active then
            clearESP() 

            -- Daftar lokasi yang ingin diperiksa
            local locations = {
                "Map.chris.Gifts",
                "Map.CHRIs.Gifts"
            }

            for _, path in pairs(locations) do
                -- Memisahkan string path menjadi bagian-bagian untuk dicheck satu per satu
                local success, targetFolder = pcall(function()
                    local current = game.Workspace
                    for folderName in path:gmatch("[^%.]+") do
                        current = current:FindFirstChild(folderName)
                    end
                    return current
                end)

                if success and targetFolder and targetFolder:IsA("Folder") then
                    for _, gift in pairs(targetFolder:GetChildren()) do
                        if gift:IsA("Model") or gift:IsA("BasePart") then
                            local highlight = Instance.new("Highlight")
                            highlight.Name = "Gift_Highlight"
                            highlight.FillColor = Color3.fromRGB(0, 255, 0) -- Hijau
                            highlight.FillTransparency = 0.5
                            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
                            highlight.OutlineTransparency = 0
                            highlight.Adornee = gift
                            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                            highlight.Parent = gift
                        end
                    end
                    print("Berhasil memasang ESP di: " .. path)
                end
            end
        else
            clearESP()
        end
    end,
})

local Toggle = MainTab:CreateToggle({
    Name = "ESP Generator (Red Highlight)",
    CurrentValue = false,
    Flag = "Generator_ESP_Red",
    Callback = function(Value)
        _G.GeneratorESP_Active = Value

        -- Fungsi untuk menghapus Highlight merah yang ada
        local function clearESP()
            for _, v in pairs(game.Workspace:GetDescendants()) do
                if v.Name == "Generator_Highlight" then
                    v:Destroy()
                end
            end
        end

        if _G.GeneratorESP_Active then
            clearESP() -- Bersihkan sisa lama agar tidak menumpuk

            -- Mencari folder atau objek bernama 'Generator' secara dinamis di seluruh Workspace
            local targetsFound = false
            for _, v in pairs(game.Workspace:GetDescendants()) do
                -- Mencari folder bernama 'Generator' atau objek yang namanya mengandung 'Generator'
                if (v.Name == "Generator" or v.Name == "Generators") then
                    targetsFound = true

                    -- Memberikan highlight ke semua isi di dalam folder tersebut
                    for _, item in pairs(v:GetChildren()) do
                        if item:IsA("Model") or item:IsA("BasePart") then
                            local highlight = Instance.new("Highlight")
                            highlight.Name = "Generator_Highlight"
                            highlight.FillColor = Color3.fromRGB(255, 0, 0) -- WARNA MERAH
                            highlight.FillTransparency = 0.4 -- Sedikit transparan agar bentuk asli terlihat
                            highlight.OutlineColor = Color3.fromRGB(255, 255, 255) -- Garis tepi putih agar tajam
                            highlight.OutlineTransparency = 0
                            highlight.Adornee = item
                            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop -- Tembus pandang/X-Ray
                            highlight.Parent = item
                        end
                    end
                end
            end

            if not targetsFound then
                print("Objek 'Generator' tidak ditemukan. Pastikan sudah muncul di Map.")
            end
        else
            clearESP()
        end
    end,
})

-- Full Bright Toggle
local Lighting = game:GetService("Lighting")
local OriginalBrightness = Lighting.Brightness
local OriginalAmbient = Lighting.Ambient
local OriginalOutdoorAmbient = Lighting.OutdoorAmbient

local Toggle = MainTab:CreateToggle({
    Name = "Full Bright",
    CurrentValue = false,
    Flag = "FullBright",
    Callback = function(Value)
        if Value then
            Lighting.Brightness = 2
            Lighting.Ambient = Color3.new(1, 1, 1)
            Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
            print("Full Bright Aktif")
        else
            Lighting.Brightness = OriginalBrightness
            Lighting.Ambient = OriginalAmbient
            Lighting.OutdoorAmbient = OriginalOutdoorAmbient
            print("Full Bright Nonaktif")
        end
    end,
})

-- No Fog Toggle
local Atmosphere = Lighting:FindFirstChild("Atmosphere")
local OriginalDensity = Atmosphere and Atmosphere.Density or 0.4
local OriginalOffset = Atmosphere and Atmosphere.Offset or 0
local OriginalColor = Atmosphere and Atmosphere.Color or Color3.new(0.5, 0.5, 0.5)

local Toggle = MainTab:CreateToggle({
    Name = "No Fog",
    CurrentValue = false,
    Flag = "NoFog",
    Callback = function(Value)
        if Atmosphere then
            if Value then
                Atmosphere.Density = 0
                Atmosphere.Offset = 0
                Atmosphere.Color = Color3.new(1, 1, 1)
                print("No Fog Aktif")
            else
                Atmosphere.Density = OriginalDensity
                Atmosphere.Offset = OriginalOffset
                Atmosphere.Color = OriginalColor
                print("No Fog Nonaktif")
            end
        else
            print("Atmosphere tidak ditemukan di Lighting.")
        end
    end,
})
